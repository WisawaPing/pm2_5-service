{"version":3,"sources":["../../src/controllers/atmosphere.controller.js"],"names":["Atmosphere","db","include","create","req","res","body","status","send","response_status","message","data","err","findAll","query","offset","limit","page","Number","where","order","resultRes","newResultRes","map","value","fileRecords","JSON","parse","dataValues","pathPic","findOne","id","params","findByPk","newData","update","result","console","log","remove","destroy"],"mappings":"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","file":"atmosphere.controller.js","sourcesContent":["import db from \"~/models\";\n\nconst { Atmosphere } = db;\nconst include = [];\n\nconst create = async (req, res) => {\n  try {\n    // Validate request\n    if (!req.body) {\n      res.status(200).send({\n        response_status: \"ERROR\",\n        message: \"Content can not be empty!\",\n      });\n      return;\n    }\n\n    const data = await Atmosphere.create(req.body);\n    if (!data) {\n      res.send({\n        response_status: \"ERROR\",\n        message: err.message || \"Some error occurred while creating.\",\n      });\n      return;\n    }\n    res.status(201).send({\n      response_status: \"SUCCESS\",\n      data,\n    });\n  } catch (err) {\n    res.send({\n      response_status: \"ERROR\",\n      message: err.message || \"Some error occurred while creating.\",\n    });\n  }\n};\n\nconst findAll = async (req, res) => {\n  try {\n    let { query } = req;\n    let { offset, limit, page } = query;\n    if (offset || limit || page) {\n      delete query.offset;\n      delete query.limit;\n      delete query.page;\n      offset = offset ? Number(offset) : null;\n      limit = limit ? Number(limit) : null;\n      if (page) {\n        offset = page ? Number(page) : null;\n      }\n    }\n    const where = query ? query : {};\n    const resultRes = await Atmosphere.findAll({\n      limit,\n      offset,\n      where,\n      include,\n      order: [\n        [\"createdAt\", \"DESC\"],\n        [\"id\", \"DESC\"],\n      ],\n    });\n\n    if (!resultRes) {\n      res.status(200).send({\n        response_status: \"ERROR\",\n        message: err.message || \"Some error occurred while finding.\",\n      });\n      return;\n    }\n    const newResultRes = resultRes.map((value) => {\n      const fileRecords = JSON.parse(value.dataValues.fileRecords)\n        ? JSON.parse(value.dataValues.fileRecords)\n        : [];\n      const pathPic = JSON.parse(value.dataValues.pathPic)\n        ? JSON.parse(value.dataValues.pathPic)\n        : [];\n      return {\n        ...value.dataValues,\n        fileRecords,\n        pathPic,\n      };\n    });\n    res.status(200).send({\n      response_status: \"SUCCESS\",\n      data: newResultRes,\n    });\n  } catch (err) {\n    res.send({\n      response_status: \"ERROR\",\n      message: err.message || \"Some error occurred while finding.\",\n    });\n  }\n};\n\nconst findOne = async (req, res) => {\n  try {\n    const { id } = req.params;\n    const data = await Atmosphere.findByPk(id, { include });\n    // console.log(\"data\", data);\n\n    if (!data) {\n      res.send({\n        response_status: \"ERROR\",\n        message: \"Some error occurred while finding.\",\n      });\n      return;\n    }\n\n    const fileRecords = JSON.parse(data.dataValues.fileRecords)\n      ? JSON.parse(data.dataValues.fileRecords)\n      : [];\n    const pathPic = JSON.parse(data.dataValues.pathPic)\n      ? JSON.parse(data.dataValues.pathPic)\n      : [];\n    let newData = {\n      ...data.dataValues,\n      fileRecords,\n      pathPic,\n    };\n\n    res.send({\n      response_status: \"SUCCESS\",\n      data: newData,\n    });\n  } catch (err) {\n    res.send({\n      response_status: \"ERROR\",\n      message: err.message || \"Some error occurred while finding.\",\n    });\n  }\n};\n\nconst update = async (req, res) => {\n  try {\n    const { id } = req.params;\n\n    const result = await Atmosphere.update(req.body, {\n      where: { id },\n    });\n\n    console.log(\"result\", result);\n\n    if (result != 1) {\n      res.status(200).send({\n        response_status: \"ERROR\",\n        message: `(ID: ${id}) was not found.`,\n      });\n      return;\n    }\n\n    res.send({\n      response_status: \"SUCCESS\",\n      message: \"Updated successfully\",\n    });\n  } catch (err) {\n    res.send({\n      response_status: \"ERROR\",\n      message: err.message || \"Some error occurred while updating.\",\n    });\n  }\n};\n\nconst remove = async (req, res) => {\n  try {\n    const { id } = req.params;\n    const result = await Atmosphere.destroy({\n      where: { id },\n    });\n\n    if (result !== 1) {\n      res.status(200).send({\n        response_status: \"ERROR\",\n        message: `Log (ID: ${id}) was not found.`,\n      });\n      return;\n    }\n\n    res.send({\n      response_status: \"SUCCESS\",\n      message: \"Deleted successfully\",\n    });\n  } catch (err) {\n    res.send({\n      response_status: \"ERROR\",\n      message: err.message || \"Some error occurred while deleting.\",\n    });\n  }\n};\n\nexport default {\n  create,\n  findAll,\n  findOne,\n  update,\n  remove,\n};\n"]}